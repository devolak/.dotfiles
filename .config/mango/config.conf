# --------------------- #
# Environment Variables #
# --------------------- #

env = XCURSOR_SIZE,24


# --------- #
# Autostart #
# --------- #

exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=wlroots
exec-once = waybar -c ~/.config/mango/waybar/config.jsonc -s ~/.config/mango/waybar/style.css
exec-once = swww-daemon
exec-once = mako
exec-once = wl-clip-persist --clipboard regular --reconnect-tries 0
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store


#----------#
# Monitors #
#----------#

monitorrule = name:DP-3, width:2560, height:1440, refresh:180, x:1921, y:0, vrr:1
monitorrule = name:DP-2, width:1920, height:1080, refresh:60, x:0, y:0


#---------#
# General #
#---------#

# System & Hardware
syncobj_enable = 1
adaptive_sync = 1
allow_tearing = 1

# Focus & Input
focus_on_activate = 1
sloppyfocus = 1
warpcursor = 1
drag_tile_to_tile = 1
axis_bind_apply_timeout = 100

cursor_hide_timeout = 0
cursor_size = 24
cursor_theme = Bibata-Modern-Ice

# Multi-Monitor & Tags
focus_cross_monitor = 0
focus_cross_tag = 0
single_scratchpad = 1
circle_layout = tile,scroller,monocle,grid,center_tile

# Window Behavior
enable_floating_snap = 0
snap_distance = 30
idleinhibit_ignore_visible = 0


#---------#
# Layouts #
#---------#

# Scroller
scroller_focus_center = 0
scroller_prefer_center = 0

scroller_structs = 20

scroller_default_proportion = 0.8
scroller_default_proportion_single = 1.0
scroller_proportion_preset = 0.33333, 0.5, 0.66667, 0.7

edge_scroller_pointer_focus = 1
scroller_ignore_proportion_single = 1

# Master-Stack
new_is_master = 1
default_nmaster = 1

default_mfact = 0.55
smartgaps = 0

# Overview
enable_hotarea = 0
hotarea_size = 10
ov_tab_mode = 0

overviewgappi = 5
overviewgappo = 30

# Scratchpad
scratchpad_width_ratio = 0.8
scratchpad_height_ratio = 0.9


#------------#
# Appearance #
#------------#

# Gaps
gappih = 4
gappiv = 4
gappoh = 6
gappov = 6

# Border
borderpx = 3
no_border_when_single = 0

rootcolor = 0x201b14ff
bordercolor = 0x54546dff
focuscolor = 0xc8c093ff
urgentcolor = 0xad401fff
maximizescreencolor = 0x89aa61ff
scratchpadcolor = 0x516c93ff
globalcolor = 0xb153a7ff
overlaycolor = 0x14a57cff

# Corner Radius
border_radius = 2
no_radius_when_single = 0

# Opacity
focused_opacity = 1.0
unfocused_opacity = 1.0

# Blur
blur = 1
blur_layer = 1
blur_optimized = 1

blur_params_radius = 5
blur_params_num_passes = 3

blur_params_noise = 0.02
blur_params_brightness = 0.9
blur_params_contrast = 0.9
blur_params_saturation = 1.2

# Shadows
shadows = 1
layer_shadows = 1
shadow_only_floating = 0

shadows_size = 4
shadows_blur = 15

shadows_position_x = 3
shadows_position_y = -3

shadowscolor = 0x16161dff

# Animations
animations = 1
layer_animations = 1
tag_animation_direction = 1

animation_type_open = zoom
animation_type_close = zoom
layer_animation_type_open = slide
layer_animation_type_close = slide

animation_fade_in = 1
animation_fade_out = 1
fadein_begin_opacity = 0.87
fadeout_begin_opacity = 0.87

zoom_initial_ratio = 0.87
zoom_end_ratio = 0.87

animation_duration_open = 410
animation_duration_close = 149
animation_duration_move = 500
animation_duration_tag = 270
animation_duration_focus = 0

animation_curve_open = 0.22, 1.0, 0.36, 1.0
animation_curve_close = 0.0, 0.0, 1.0, 1.0
animation_curve_move = 0.46, 1.0, 0.29, 1.0
animation_curve_tag = 0.22, 1.0, 0.36, 1.0
animation_curve_focus = 0.15, 0.0, 0.1, 1.0
animation_curve_opafadeout = 0.5, 0.5, 0.75, 1.0
animation_curve_opafadein = 0.5, 0.5, 0.75, 1.0


#-------#
# Input #
#-------#

# Keyboard
repeat_rate = 25
repeat_delay = 600
numlockon = 1
xkb_rules_layout = us

# Trackpad
# need relogin to make it apply
disable_trackpad = 1
tap_to_click = 1
tap_and_drag = 1
drag_lock = 1
trackpad_natural_scrolling = 0
disable_while_typing = 1
left_handed = 0
middle_button_emulation = 0
swipe_min_threshold = 1

# Mouse
# need relogin to make it apply
mouse_natural_scrolling = 0
accel_profile = 1


#----------#
# Bindings #
#----------#

# key name refer to `xev` or `wev` command output,
# mod keys name: Super,Ctrl,Alt,Shift,None

# Reload config
bind = Super, r, reload_config

# Application & Menu
bind = Super, d, spawn, fuzzel
bind = Super, Return, spawn, foot
bind = Super, e, spawn_shell, foot yazi
bind = Super, w, spawn, firefox

bind = Super+Shift, Escape, spawn, powermenu
bind = Super, a, spawn, quicksettings

# Exit
bind = Super, m, quit
bind = Super, q, killclient,

# Switch window focus
bind = Alt, Tab, focusstack, next
bind = Alt+Shift, Tab, focusstack, prev
bind = Super, h, focusdir, left
bind = Super, l, focusdir, right
bind = Super, k, focusdir, up
bind = Super, j, focusdir, down

# Swap window
bind = Super+Shift, h, exchange_client, left
bind = Super+Shift, l, exchange_client, right
bind = Super+Shift, k, exchange_client, up
bind = Super+Shift, j, exchange_client, down

# Switch window status
bind = Super, g, toggleglobal,
bind = Super, Tab, toggleoverview,
bind = Super, Backslash, togglefloating,
bind = Super, f, togglemaximizescreen,
bind = Super+Shift, f, togglefullscreen,
bind = Ctrl+Super, f, togglefakefullscreen,
bind = Super, i, minimized,
bind = Super, o, toggleoverlay,
bind = Super+Shift, i, restore_minimized
bind = Super, s, toggle_scratchpad

# Scroller layout
bind = Alt, e, set_proportion, 1.0
bind = Alt, x, switch_proportion_preset,

# Switch layout
bind = Super, n, switch_layout

# Tag switch
bind = Super, Left, viewtoleft, 0
bind = Ctrl, Left, viewtoleft_have_client, 0
bind = Super, Right, viewtoright, 0
bind = Ctrl, Right, viewtoright_have_client, 0
bind = Ctrl+Super, Left, tagtoleft, 0
bind = Ctrl+Super, Right, tagtoright, 0

bind = Super, 1, view, 1, 0
bind = Super, 2, view, 2, 0
bind = Super, 3, view, 3, 0
bind = Super, 4, view, 4, 0
bind = Super, 5, view, 5, 0
bind = Super, 6, view, 6, 0
bind = Super, 7, view, 7, 0
bind = Super, 8, view, 8, 0
bind = Super, 9, view, 9, 0

# Tag: move client to the tag and focus it
# tagsilent: move client to the tag and not focus it
# bind = Super+Shift, 1, tagsilent, 1
bind = Super+Shift, 1, tag, 1, 0
bind = Super+Shift, 2, tag, 2, 0
bind = Super+Shift, 3, tag, 3, 0
bind = Super+Shift, 4, tag, 4, 0
bind = Super+Shift, 5, tag, 5, 0
bind = Super+Shift, 6, tag, 6, 0
bind = Super+Shift, 7, tag, 7, 0
bind = Super+Shift, 8, tag, 8, 0
bind = Super+Shift, 9, tag, 9, 0

# Monitor switch
bind = Super+Alt, h, focusmon, left
bind = Super+Alt, l, focusmon, right
bind = Super+Alt+Shift, h, tagmon, left
bind = Super+Alt+Shift, l, tagmon, right

# Movewin
bind = Ctrl+Shift, Up, movewin, +0, -50
bind = Ctrl+Shift, Down, movewin, +0, +50
bind = Ctrl+Shift, Left, movewin, -50, +0
bind = Ctrl+Shift, Right, movewin, +50, +0

# Resizewin
bind = Ctrl+Super, h, setmfact, -0.025
bind = Ctrl+Super, l, setmfact, +0.025
bind = Ctrl+Alt, Up, resizewin, +0, -50
bind = Ctrl+Alt, Down, resizewin, +0, +50
bind = Ctrl+Alt, Left, resizewin, -50, +0
bind = Ctrl+Alt, Right, resizewin, +50, +0

# Mouse Button Bindings
# btn_left and btn_right can't bind none mod key
mousebind = Super, btn_left, moveresize, curmove
mousebind = Super, btn_middle, togglemaximizescreen, 0
mousebind = Super, btn_right, moveresize, curresize


# Axis Bindings
axisbind = Super, Up, viewtoleft_have_client
axisbind = Super, Down, viewtoright_have_client

# Volume
bindl = None, XF86AudioRaiseVolume, spawn_shell, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+ -l 1.0 && volumenotification
bindl = None, XF86AudioLowerVolume, spawn_shell, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%- && volumenotification
bindl = None, XF86AudioMute, spawn_shell, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle && volumenotification

# Media
bindl = None, XF86AudioNext, spawn_shell, playerctl next
bindl = None, XF86AudioPrev, spawn_shell, playerctl previous
bindl = None, XF86AudioPlay, spawn_shell, playerctl play-pause


#-------#
# Rules #
#-------#

# Tag
# layout support:
# tile,scroller,grid,deck,monocle,center_tile,vertical_tile,vertical_scroller
tagrule = id:1, layout_name:tile
tagrule = id:2, layout_name:tile
tagrule = id:3, layout_name:tile
tagrule = id:4, layout_name:tile
tagrule = id:5, layout_name:tile
tagrule = id:6, layout_name:tile
tagrule = id:7, layout_name:tile
tagrule = id:8, layout_name:tile
tagrule = id:9, layout_name:tile

# Layer
layerrule = animation_type_open:slide, layer_name:launcher
layerrule = animation_type_close:slide, layer_name:launcher

# Window
windowrule = appid:^(.*)$, allow_csd:0
windowrule = appid:^(steam_app_.*|steam_proton|streaming_client|gamescope|starcitizen.exe|Terraria.bin.x86_64)$, tags:9, force_tearing:1
